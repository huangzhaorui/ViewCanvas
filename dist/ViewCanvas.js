(()=>{var __webpack_modules__={562:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>Tool});var uuid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(586),color__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(767),color__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(color__WEBPACK_IMPORTED_MODULE_0__),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};class Tool{static getUUID(e){return e+(0,uuid__WEBPACK_IMPORTED_MODULE_1__.Z)()}static debounce(e,t){let i;return function(){let r=arguments;i&&clearTimeout(i),i=setTimeout((()=>{e.apply(this,r)}),t)}}static throttle(e,t){let i;return function(){let r=this,s=arguments;i||(i=setTimeout((()=>{i=null,e.apply(r,s)}),t))}}static setConfig(e){for(const t in e)this[t]=e[t]}static getColor(e){let{color:t,valpha:i}=color__WEBPACK_IMPORTED_MODULE_0___default()(e);return{r:t[0],g:t[1],b:t[2],a:i}}static setColor({r:e,g:t,b:i,a:r=1}){return color__WEBPACK_IMPORTED_MODULE_0___default()({r:e,g:t,b:i}).alpha(r)}static checkNone(e){return!["",null,void 0].includes(e)}static judgeType(e,t=3){return Object.prototype.toString.call(e)===`[object ${["String","Number","Boolean","Object","Array","Function","undefined","Null"][t]}]`}static setDefaultValue(e,t){return[void 0,null].includes(e)?t:e}static paramsMerge(){let e={};for(let t=0;t<arguments.length;t++){let i=_extends({},e),r=arguments[t]||{};for(const e in i)["",void 0].includes(r[e])||(i[e]=r[e]);e=_extends({},r,i)}return e}static toFixed(e,t=2){return Math.floor(e)}static setDirection(e,t){function i(e,t){let i=Math.floor(e.x)-Math.floor(t.x),r=Math.floor(e.y)-Math.floor(t.y);return 0===i?r<0?"bottom":"top":0===r?i<0?"right":"left":void 0}let r=e.length-1,s=null,n=null;this.index=t,this.prev=null,this.next=null,0===t?(n=i(e[t],e[t+1]),this.next=e[t+1]):t===r?(s=i(e[t],e[t-1]),this.prev=e[t-1]):(s=i(e[t],e[t-1]),n=i(e[t],e[t+1]),this.prev=e[t-1],this.next=e[t+1]),this.direction={prev:s,next:n}}static judgeAngle(e,t){let i=t.x-e.x,r=t.y-e.y;return 360*Math.atan(r/i)/(2*Math.PI)}static observe(e,t){Object.keys(e).forEach((i=>{let r=e[i];Object.defineProperty(e,i,{set(e){t&&t(),r=e},get:()=>r})}))}static judgeXY(e,t,i){let r=Math.sin(Math.PI/180*e)*i,s=Math.cos(Math.PI/180*e)*i;return{x:t.x+r,y:t.y+s}}static evalMathStr(str,v){let s=str,value;/%/g.test(str)&&(str=str.replace(/%/g,"*"+v/100)),/px/g.test(str)&&(str=str.replace(/px/g,""));try{value=eval(str)}catch(e){console.error("字符串模板不正确：",s,e)}return value}}},248:(e,t,i)=>{"use strict";i.d(t,{Z:()=>E});var r=i(562);class s{constructor(e){this.name=e,this.elements=[]}add(e,t){t.id||(t.id=r.Z.getUUID("view_canvas_el:")),t.zIndex=this.elements.length,t.layer=this.name;const i=new e(t);return this.elements.push(i),i}get(e){let{type:t,id:i,canRender:r}=e;return void 0!==t?this.elements.filter((e=>e.type===t)):void 0!==i?this.elements.find((e=>e.id===i)):void 0!==r?this.elements.filter((e=>e.canRender===r)):void 0}remove(e){if(e){let t=this.elements.findIndex((t=>t.id===e));this.elements[t].destroy(),this.elements.splice(t,1)}}clear(){this.elements.forEach((e=>e.destroy())),this.elements=[]}}var n=i(379),o=i.n(n),l=i(128);o()(l.Z,{insert:"head",singleton:!1}),l.Z.locals;class a extends class{constructor(){this.id=r.Z.getUUID("view_canvas:"),this.cursorClass={default:"cursor_default",hover:"cursor_pointer",move:"cursor_move",drag:"cursor_grab",wait:"cursor_wait",select:"cursor_select",l_r_arrow:"cursor_l_r_arrow",t_b_arrow:"cursor_t_b_arrow",lb_rt_arrow:"cursor_lb_rt_arrow",lt_rb_arrow:"cursor_lt_rb_arrow",text:"cursor_text",disabled:"cursor_disabled",zoom_in:"cursor_zoom_in",zoom_out:"cursor_zoom_out"},this.fps=60,this.mode=View.MODE.DEFAULT,this.saveMode=[],this.beforeFreezeMode=null,this.width=0,this.height=0,this.isResize=!0,this.background="transparent",this.offsetX=0,this.offsetY=0,this.zoomObj={fontX:0,fontY:0,fontZoom:10,curZoom:10},this.min_scale=1,this.max_scale=30,this.canRender=!1,this.canEvent=!1,this.canDrag=!1,this.canMove=!1,this.canZoom=!1,this.canSelect=!1,this.isRender=!1,this.isDown=!1,this.isMove=!1,this.isDrag=!1,this.isCanUseSelect=!1,this.mouseDownEl=null,this.clickEl=null,this.hoverEl=null,this.dragEl=null,this.selectEl=null,this.isSelectElements=[],this.mouseDownPosition=null,this.mouseOldPosition=null,this.mouseMoveEvent=null,this.sceneRenderFlag=null,this.mouseDownTime=null,this.showViewArea=!1,this.viewArea={x1:0,y1:0,x2:0,y2:0}}}{constructor({parent:e,config:t,handler:i,name:r,zIndex:n}){super(),this.name=r,this.defaultZIndex=n,this.renderZIndex=n,this.parent=e;for(let e in t)this[e]=t[e];for(let e in i)this[e]=i[e];this.layers={control:new s("control"),temporary:new s("temporary"),element:new s("element"),background:new s("background")},this.canvasFront=document.createElement("canvas",{alpha:!1}),this.canvasFront.setAttribute("id",this.id+"_front"),this.canvasFront.setAttribute("tabindex",n),this.renderContext=this.canvasFront.getContext("bitmaprenderer"),this.parent.appendChild(this.canvasFront),this.setSceneZIndex(),this.resizeView(),this.setSceneMode(this.mode),this.eventListener(),this.renderHandler()}setSceneMode(e=E.MODE.DEFAULT){this.mode=e,this.canRender=e[0],this.canEvent=e[1],this.canDrag=e[2],this.canMove=e[3],this.canZoom=e[4],this.canSelect=e[5]}setSceneZIndex(){let e={position:"absolute",background:this.background,margin:"auto",top:"1px",left:"1px","z-index":this.renderZIndex},t="";for(let i in e)t+=`${i}:${e[i]};`;this.canvasFront.setAttribute("style",t)}resizeView(){this.width=this.parent.clientWidth-2,this.height=this.parent.clientHeight-2,this.canvasFront.setAttribute("width",this.width),this.canvasFront.setAttribute("height",this.height),this.canvasBack=new OffscreenCanvas(this.width,this.height),this.context=this.canvasBack.getContext("2d"),this.changeViewArea()}changeViewArea(){const e=this.zoomObj.curZoom/10;this.viewArea.x1=-this.offsetX/e,this.viewArea.y1=-this.offsetY/e,this.viewArea.x2=(-this.offsetX+this.width)/e,this.viewArea.y2=(-this.offsetY+this.height)/e}renderHandler(){const e=this;let t=(new Date).getTime();!function i(){if(!e.isRender&&e.canRender){let i=(new Date).getTime();i-t>=1e3/e.fps&&(t=i,e.render())}e.sceneRenderFlag=requestAnimationFrame(i)}()}destroyScene(){return this.sceneRenderFlag&&(cancelAnimationFrame(this.sceneRenderFlag),this.sceneRenderFlag=null),this.id}render(){this.isRender=!0,this.context.setTransform(this.zoomObj.curZoom/10,0,0,this.zoomObj.curZoom/10,this.offsetX,this.offsetY),this.layerRender("background"),this.layerRender("element"),this.layerRender("temporary"),this.layerRender("control"),this.otherRenderCall&&this.otherRenderCall(this),this.viewAreaRender(),this.useSelectModeHandler();let e=this.canvasBack.transferToImageBitmap();this.renderContext.transferFromImageBitmap(e),this.isRender=!1}layerRender(e){let{context:t,zoomObj:i,offsetX:r,offsetY:s}=this;this.layers[e].elements.sort(((e,t)=>e.renderZIndex-t.renderZIndex)).forEach((e=>e.render(t,i.curZoom/10,r,s)))}viewAreaRender(){const{x1:e,y1:t,x2:i,y2:r}=this.viewArea;if(!this.showViewArea)return;const s=this.context;s.save(),s.beginPath(),s.strokeStyle="#515a6e",s.rect(e,t,i-e,r-t),s.stroke(),s.restore();const n=this.zoomObj.curZoom/10,o=`elements：${this.layers.element.elements.length}，x：${e}，y：${t}，scale：${this.zoomObj.curZoom}`;new E.Elements.Text(s,e+10/n,t+15/n,{fontText:o,fontColor:"#515a6e",fontSize:16/n,fontAlign:"left"})}useSelectModeHandler(){const{x1:e,y2:t}=this.viewArea,{context:i,canSelect:r,isCanUseSelect:s}=this;if(!s)return;let n="#2d8cf0",o="按下左Ctrl进入框选模式";r&&(n="#ed4014",o="已进入框选模式，按下左Ctrl退出");const l=this.zoomObj.curZoom/10;new E.Elements.Text(i,e+10/l,t-15/l,{fontText:o,fontSize:16/l,fontColor:n,fontAlign:"left"})}eventListener(){this.canvasFront.oncontextmenu=e=>!1,this.canvasFront.onmousedown=e=>{if(!this.canEvent)return;let{offsetX:t,offsetY:i}=e;this.mouseDownPosition={offsetX:t,offsetY:i},this.mouseOldPosition={offsetX:t,offsetY:i},this.mouseDownEl=this.judgeHasElementInMouseRange(e),this.isDown=!0,this.mouseDownTime=(new Date).getTime()},this.canvasFront.ondblclick=e=>{this.canEvent},this.canvasFront.onmouseup=e=>{if(!this.canEvent)return;if(this.mouseDownPosition=null,this.mouseDownTime=null,this.isDown=!1,this.mouseDownEl=!1,this.isDrag&&this.dragEl)return this.isDrag=!1,this.dragEl.isDrag=!1,this.dragEl.renderZIndex=this.dragEl.defaultZIndex,["Container"].includes(this.dragEl.type)&&this.dragEl.childrenDragCall(this.context,!1),this.dragEl.canDrag&&this.dragEndCall&&this.dragEndCall(e,this.dragEl),this.dragEl.isHover=!0,this.hoverEl=this.dragEl,this.canvasFront.classList=[this.cursorClass[this.hoverEl.elementMouseStyleHandler("hover")]],["Container"].includes(this.dragEl.type)?this.dragEl.childrenHoverCall(this.context):this.hoverCall&&this.hoverCall(e,this.hoverEl),void(this.dragEl=null);if(this.isMove)return this.canvasFront.classList=[this.cursorClass.default],this.isMove=!1,this.setSelectRangeAndElement(e),void this.layers.temporary.clear();let t=this.judgeMouseEnter(e),i=this.judgeHasElementInMouseRange(e);if(i)switch(t){case"left":if(this.judgeIsSameEl(i,"click")){["Container"].includes(i.type)?i.childrenClickCall(this.context,!1):(this.clickEl&&(this.clickEl.isClick=!1,this.handlerChildrenElementCancel(e),this.clickEl.canClick&&this.cancelCall&&this.cancelCall(e,this.clickEl)),this.clickEl.canClick&&this.cancelCall&&this.cancelCall(e,this.clickEl),this.clickEl=null);break}this.clickEl&&(this.clickEl.isClick=!1,this.handlerChildrenElementCancel(e),this.clickEl.canClick&&this.cancelCall&&this.cancelCall(e,this.clickEl)),["Container"].includes(i.type)?i.childrenClickCall(this.context,!0):(i.isClick=!0,this.clickEl=i,i.canClick&&this.clickCall&&this.clickCall(e,i));break;case"right":["Container"].includes(i.type)&&(i=i.childrenOtherClickCall(this.context)),this.rightClickCall&&this.rightClickCall(e,i);break;case"center":["Container"].includes(i.type)&&(i=i.childrenOtherClickCall(this.context)),this.centerClickCall&&this.centerClickCall(e,i)}else this.clickEl&&(this.clickEl.isClick=!1,this.handlerChildrenElementCancel(e),this.clickEl.canClick&&this.cancelCall&&this.cancelCall(e,this.clickEl)),this.clearSelectBorderInElementLayer(),this.noneClickCall&&this.noneClickCall(e),this.clickEl=null},this.canvasFront.onmousemove=e=>{if(!this.canEvent)return;this.mouseMoveEvent=e;let t=null;if(this.isMove||(t=this.judgeHasElementInMouseRange(e)),!this.isMove&&this.dragEl){this.canvasFront.classList=[this.cursorClass[this.dragEl.elementMouseStyleHandler("drag")]],this.elDragOffset(e,this.dragEl);let{offsetX:t,offsetY:i}=e;return this.mouseOldPosition={offsetX:t,offsetY:i},void(this.dragEl.canDrag&&this.dragCall&&this.dragCall(e,this.dragEl))}if(!this.isMove&&t)if(this.canDrag&&this.mouseDownEl&&this.judgeIsMouseDownAndMove()&&(this.isDrag=!0),this.isDrag){this.hoverEl&&(this.hoverEl.isHover=!1,this.handlerChildrenElementLeave(e),this.hoverEl.canHover&&this.leaveCall&&this.leaveCall(e,this.hoverEl),this.hoverEl=null),this.dragEl=t,t.isDrag=!0,t.renderZIndex=this.layers.element.elements.length,this.elDragOffset(e,t);let{offsetX:i,offsetY:r}=e;this.mouseOldPosition={offsetX:i,offsetY:r},["Container"].includes(t.type)&&t.childrenDragCall(this.context,!0),t.canDrag&&this.dragStartCall&&this.dragStartCall(e,t)}else t.isHover=!0,this.judgeIsSameEl(t,"hover")?["Container"].includes(t.type)&&t.childrenHoverCall(this.context):(this.hoverEl&&(this.hoverEl.isHover=!1,this.handlerChildrenElementLeave(e),this.hoverEl.canHover&&this.leaveCall&&this.leaveCall(e,this.hoverEl)),this.canvasFront.classList=[this.cursorClass[t.elementMouseStyleHandler("hover")]],t.canHover&&this.hoverCall&&this.hoverCall(e,t)),this.hoverEl=t;else{if(this.canSelect&&this.isDown){if(this.judgeIsMouseDownAndMove()&&(this.isMove=!0),!this.isMove)return;let t=this.layers.temporary.get({type:"SelectBorder"});this.canvasFront.classList=[this.cursorClass.select];let{offsetX:i,offsetY:r}=this.mouseDownPosition;const s=this.zoomObj.curZoom/10;if(t.length){let n=t[0],o=e.offsetX-i,l=e.offsetY-r;n.setSize(o/s,l/s)}else this.clearSelectBorderInElementLayer(),this.add({type:"SelectBorder",x:(i-this.offsetX)/s,y:(r-this.offsetY)/s,params:{width:0,height:0}},"temporary");return}if(this.canMove&&this.isDown){if(this.judgeIsMouseDownAndMove()&&(this.isMove=!0),!this.isMove)return;this.canvasFront.classList=[this.cursorClass.move];let{offsetX:t,offsetY:i}=e;return this.offsetX+=t-this.mouseDownPosition.offsetX,this.offsetY+=i-this.mouseDownPosition.offsetY,this.mouseDownPosition.offsetX=t,this.mouseDownPosition.offsetY=i,this.changeViewArea(),void(this.moveCall&&this.moveCall(e))}this.hoverEl&&(this.hoverEl.isHover=!1,this.handlerChildrenElementLeave(e),this.canvasFront.classList=[this.cursorClass.default],this.hoverEl.canHover&&this.leaveCall&&this.leaveCall(e,this.hoverEl)),this.hoverEl=null}},this.canvasFront.onmousewheel=e=>{if(!this.canEvent)return;let{offsetX:t,offsetY:i}=e,r=0;e.deltaY>0?(this.canvasFront.classList=[this.cursorClass.zoom_out],this.canZoom&&this.zoomObj.curZoom>this.min_scale&&(r=-.5),this.zoomCall&&this.zoomCall(e,-1)):(this.canvasFront.classList=[this.cursorClass.zoom_in],this.canZoom&&this.zoomObj.curZoom<this.max_scale&&(r=.5),this.zoomCall&&this.zoomCall(e,1)),setTimeout((()=>{this.hoverEl?this.canvasFront.classList=[this.cursorClass[this.hoverEl.elementMouseStyleHandler("hover")]]:this.canvasFront.classList=[this.cursorClass.default]}),100);let s=this.zoomObj.fontZoom+r;this.zoomOffset(s,t,i)},this.canvasFront.onkeydown=e=>{if(!this.canEvent)return;let{code:t}=e;if("ControlLeft"===t){if(!this.isCanUseSelect)return;this.canSelect?(this.clearSelectBorderInElementLayer(),this.setSceneMode(this.saveMode)):(this.saveMode=[...this.mode],this.setSceneMode(E.MODE.SELECT))}this.canvasFront.focus()}}handlerChildrenElementLeave(e){this.hoverEl.children&&this.hoverEl.hoverEl&&(this.hoverEl.hoverEl.isHover=!1,this.hoverEl.hoverEl.canHover&&this.leaveCall&&this.leaveCall(e,this.hoverEl.hoverEl),this.hoverEl.hoverEl=null)}handlerChildrenElementCancel(e){this.clickEl.children&&this.clickEl.clickEl&&(this.clickEl.clickEl.isClick=!1,this.clickEl.clickEl.canClick&&this.cancelCall&&this.cancelCall(e,this.clickEl.clickEl),this.clickEl.clickEl=null)}setSelectRangeAndElement(e){if(0===this.layers.temporary.elements.length)return;const t=this.layers.temporary.elements[0],{x:i,y:r,width:s,height:n}=t;let o=this.layers.element.elements.filter((e=>!["BrokenLine"].includes(e.type)&&e.canRender)),l=t.boundaries;if(o.forEach(((e,t)=>{const i=e.boundaries;i[0][0]>=l[0][0]&&i[0][1]>=l[0][1]&&i[2][0]<=l[2][0]&&i[2][1]<=l[2][1]&&this.isSelectElements.push(e)})),0===this.isSelectElements.length)return;let a=this.isSelectElements[0].boundaries[0][0],h=this.isSelectElements[0].boundaries[0][1],c=this.isSelectElements[0].boundaries[2][0],d=this.isSelectElements[0].boundaries[2][1];this.isSelectElements.forEach((e=>{e.isSelect=!0;const{boundaries:t}=e;a>=t[0][0]&&(a=t[0][0]),c<=t[2][0]&&(c=t[2][0]),h>=t[0][1]&&(h=t[0][1]),d<=t[2][1]&&(d=t[2][1])}));let u={type:"SelectBorder",x:i,y:r,params:{width:s,height:n},actions:{default:{shadowSize:0,backgroundColor:"rgba(0,0,0,.25)"},hover:{shadowSize:0,backgroundColor:"rgba(0,0,0,.25)"}},animations:{x:{process:{0:i,100:a},duration:.1,loop:!1},y:{process:{0:r,100:h},duration:.1,loop:!1},width:{process:{0:s,100:c-a},duration:.1,loop:!1},height:{process:{0:n,100:d-h},duration:.1,loop:!1},backgroundColor:{process:{0:t.style.backgroundColor,100:"rgba(0,0,0,.25)"},duration:.1,loop:!1}}};this.selectEl=this.add(u),this.selectEl.relationEl={},this.isSelectElements.forEach(((e,t)=>{this.selectEl.relationEl[e.id]=e,e.relationChange=(t,i)=>{e.elOffset(i)}})),this.selectCall&&this.selectCall(e,this.selectEl,this.isSelectElements)}clearSelectBorderInElementLayer(){let e=this.layers.element.get({type:"SelectBorder"});e.length&&(e[0].clearRelationEl(),this.remove(e),this.isSelectElements=[],this.selectEl=null,this.cancelSelectCall&&this.cancelSelectCall())}judgeIsSameEl(e,t){let i=!1;return this[`${t}El`]&&(i=e.id===this[`${t}El`].id),i}judgeMouseEnter(e){let{button:t,buttons:i}=e;return 0===t&&0===i?"left":2===t&&0===i?"right":1===t&&0===i?"center":void 0}judgeHasElementInMouseRange(e){const t=this.layers.element.get({canRender:!0}).filter((e=>e.canEvent)).filter((t=>t.judgeValueIsInRange(e,this.context)));return t.length?(t.sort(((e,t)=>t.renderZIndex-e.renderZIndex)),t[0]):null}judgeIsMouseDownAndMove(){let e=(new Date).getTime();return!!(this.isDown&&e-this.mouseDownTime>60)}elDragOffset(e,t){t.elOffset(e)}add(e,t="element"){let{type:i}=e;return e.sceneId=this.id,this.layers[t].add(E.Elements[i],e)}remove(e){let t=[];r.Z.judgeType(e)&&(t=[e]),r.Z.judgeType(e,4)&&(t=[...e]),t.forEach((e=>{let{layer:t,id:i}=e;e&&this.layers[t].remove(i)}))}clear(e="element"){this.layers[e].clear()}computeAllElementBoundary(){let e={x1:0,x2:0,y1:0,y2:0};this.layers.element.elements.forEach(((t,i)=>{let{boundaries:r}=t,s=r[0][0],n=r[2][0],o=r[0][1],l=r[2][1];s<e.x1&&(e.x1=s),n>e.x2&&(e.x2=n),o<e.y1&&(e.y1=o),l>e.y2&&(e.y2=l)}));let{x1:t,y1:i,x2:r,y2:s}=e;return[t,i,r-t,s-i]}showAllView(){const{width:e,height:t}=this;let i=this.computeAllElementBoundary(),r=i[0]+i[2]/2,s=i[1]+i[3]/2;e/i[2]>=t/i[3]?this.zoomObj.curZoom=t/i[3]*10:this.zoomObj.curZoom=e/i[2]*10,this.setViewInPosition(r,s),this.zoomObj.fontX=this.offsetX,this.zoomObj.fontY=this.offsetY,this.zoomObj.fontZoom=this.zoomObj.curZoom}setViewInPosition(e,t){const{zoomObj:i,width:r,height:s}=this,n=i.curZoom/10;this.offsetX=-e*n+r/2,this.offsetY=-t*n+s/2,this.changeViewArea()}setZoom(e){let t=this.zoomObj.fontZoom+e;e>0&&t>this.max_scale&&(t=this.max_scale),e<0&&t<this.min_scale&&(t=this.min_scale);let i=this.width/2,r=this.height/2;this.zoomOffset(t,i,r)}zoomOffset(e,t,i){this.zoomObj.curZoom=e,this.offsetX=t-(t-this.offsetX)*this.zoomObj.curZoom/this.zoomObj.fontZoom,this.offsetY=i-(i-this.offsetY)*this.zoomObj.curZoom/this.zoomObj.fontZoom,this.zoomObj.fontY=i,this.zoomObj.fontX=t,this.zoomObj.fontZoom=this.zoomObj.curZoom,this.changeViewArea()}}var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};class c{constructor(e,t,i){this.sceneId=i,this.key=t,this.loop=!0,this.process={},this.duration=.5,this.timingFunction="ease",this.isRender=!0,this.startTime=0,this.direction=!0,this.localFrame=1,this.allFrame=0,this.step=null,r.Z.setConfig.call(this,e),["backgroundColor","fontColor","borderColor","lineColor","shadowColor","arrowColor"].includes(this.key)?(this.isColor=!0,this.colors=[r.Z.getColor(this.process[0]),r.Z.getColor(this.process[100])]):this.isColor=!1,this.computedFrame()}computedFrame(){let e=E.SCENE_LIST[this.sceneId].fps,{duration:t,startTime:i,process:r}=this;if(this.allFrame=Math.floor(t*e),this.isColor){let e=this.colors[0],t=this.colors[1];this.step={r:(t.r-e.r)/this.allFrame,g:(t.g-e.g)/this.allFrame,b:(t.b-e.b)/this.allFrame,a:(t.a-e.a)/this.allFrame}}else this.step=(r[100]-r[0])/this.allFrame;this.localFrame+=Math.floor(i*e)}render(e){let{isRender:t,loop:i,direction:r,allFrame:s}=this;return t?(i?(r?this.localFrame++:this.localFrame--,this.localFrame===s?this.direction=!1:1===this.localFrame&&(this.direction=!0)):(this.localFrame++,this.localFrame===s&&(this.isRender=!1)),this.computedValue()):e}computedValue(){let{process:e,step:t,isColor:i,colors:s,localFrame:n,allFrame:o}=this;if(1===n)return e[0];if(n===o)return e[100];if(i){let e=s[0].r+(n-1)*t.r,i=s[0].g+(n-1)*t.g,o=s[0].b+(n-1)*t.b,l=s[0].a+(n-1)*t.a;return r.Z.setColor({r:e,g:i,b:o,a:l})}return e[0]+(n-1)*t}}class d{constructor(e,t){let i=new Image;i.src=e,i.crossOrigin="anonymous",i.onload=()=>{t.imgRender[e]=i,E.IMAGE_LIST[e]=i}}}class u{constructor(e){const{type:t,context:i,el:s,range:n,direction:o,colors:l}=e;let a=[],{boundaries:h,center:c}=s;if("Linear"===t){const e={t_b:[0,3],l_r:[0,1],lt_rb:[0,2],lb_rt:[3,1]}[o||"t_b"];a=[h[e[0]][0],h[e[0]][1],h[e[1]][0],h[e[1]][1]]}if("Radial"===t){let{x:e,y:t}=c,i=Math.abs(h[0][0]-h[2][0])/2,r=Math.abs(h[0][1]-h[2][1])/2,s=i>=r?r:i;a=[e,t,s/2,e,t,s]}r.Z.judgeType(n,4)&&![4,6].includes(n.length)&&(a=[...n]),this.gradient=i[`create${t}Gradient`](...a),l.forEach((e=>{this.addColorStop(e[1],e[0])}))}getColor(){return this.gradient}addColorStop(e,t){this.gradient.addColorStop(e,t)}}var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};class g{constructor(e){let{id:t,sceneId:i,layer:s,x:n,y:o,zIndex:l,type:a,actions:h={},otherRender:c,animations:d={},parent:u,data:f}=e;void 0===e.params&&(e.params={}),this.CONFIG=e,this.id=t,r.Z.judgeType(f)&&(this.data=JSON.parse(JSON.stringify(f))),this.parent=u,this.sceneId=i,this.layer=s,this.type=a,this.x=n||0,this.y=o||0,this.oX=0,this.oY=0,this.defaultZIndex=l||0,this.renderZIndex=l||0,this.style={},this.actions={change:{}},this.animations={},this.scale=1,this.canRender=!0,this.disabled=r.Z.setDefaultValue(e.params.disabled,!1),this.canEvent=r.Z.setDefaultValue(e.params.canEvent,!0),this.canHover=r.Z.setDefaultValue(e.params.canHover,!0),this.canClick=r.Z.setDefaultValue(e.params.canClick,!0),this.canDrag=r.Z.setDefaultValue(e.params.canDrag,!0),this.canSelect=r.Z.setDefaultValue(e.params.canSelect,!0),this.canEdit=r.Z.setDefaultValue(e.params.canEdit,!0),this.isHasAction=!0,this.isSelect=!1,this.isTransition=r.Z.setDefaultValue(e.params.isTransition,!0),this.imgRender={},c&&(this.otherRender=c),this.boundaries=[],this.defaultBoundaries=[],this.center={x:0,y:0,rotate:0},this.rotateCenter=r.Z.setDefaultValue(e.params.rotateCenter,null),this.relationEl={},this.feedbackCall=null,this.actionRenderCall=null,this.showTestLine=r.Z.setDefaultValue(e.params.showTestLine,!1),this.showTestBoundariesPoint=r.Z.setDefaultValue(e.params.showTestBoundariesPoint,!1),this.cursorStyle=r.Z.setDefaultValue(e.params.cursorStyle,""),this.isShowEditPoint=r.Z.setDefaultValue(e.params.isShowEditPoint,!1),this.editPoints=[],this.editPointsR=r.Z.setDefaultValue(e.params.editPointsR,6),this.elementStyleMerge(h),this.setAnimations(d),Object.defineProperties(this,{_isHover_:{value:!1,writable:!0},_isClick_:{value:!1,writable:!0},_isDrag_:{value:!1,writable:!0},isHover:{get(){return this._isHover_},set(e){this.actionsTrigger("Hover",e)}},isClick:{get(){return this._isClick_},set(e){this.actionsTrigger("Click",e)}},isDrag:{get(){return this._isDrag_},set(e){this.actionsTrigger("Drag",e)}}})}render(e,t,i,r){this.judgeIsInSceneViewArea(),this.canRender&&(this.animationsRender(),this.scale=t,this.oX=i,this.oY=r,e.save(),this.disabled&&(e.globalAlpha=.5),this.setAlpha(e),this.setRotate(e),e.save(),this.isHasAction&&this.optionRender(e),this.setShadow(e),this.otherRender?this.otherRender(e):this.backgroundRender(e),e.restore(),this.actionRenderCall&&this.actionRenderCall(e,this),this.isSelect&&this.selectRender(e),this.preRender&&this.preRender(e),this.childrenRender&&this.childrenRender(e),!["BrokenLine","StraightLine"].includes(this.type)&&this.showTestLine&&this.selectRender(e,"black",!1),e.restore(),this.showTestBoundariesPoint&&this.showBoundariesPoint(e))}actionsTrigger(e,t){if(this.disabled)return;if(!this[`can${e}`])return;let i=`is${e}`;if(this[`_${i}_`]!==t){this.isHasAction=!0,this[`_${i}_`]=t;let s=e.toLocaleLowerCase();if(this.eventCall&&this.eventCall(s,t),!this.isTransition)return;const{isHover:n,isClick:o,isDrag:l}=this,a={"hover:0-0-0":"default","hover:1-0-0":"hover","hover:1-1-0":"","click:0-0-0":"default","click:1-1-0":"click","click:1-0-0":"hover","drag:0-0-1":"drag","drag:0-1-1":"drag","drag:0-1-0":"click"}[`${s}:${n-0}-${o-0}-${l-0}`];if(!a)return;let h=this.actionsParamsMerge(a,!1),c=this.actions.transition,d={};const u=["backgroundColor","rotate","alpha","fontSize","fontColor","borderSize","borderColor","shadowSize","shadowOffsetX","shadowOffsetY","shadowColor","lineWidth","lineColor","arrowSize","arrowColor"];for(const e in c)if(u.includes(e)){let t=this.style[e],i=h[e];r.Z.checkNone(t)&&r.Z.checkNone(i)&&(d[e]={process:{0:t,100:i},duration:c[e],loop:!1})}this.setAnimations(d)}}elementStyleMerge(e){const t=E.Style.Element,i=E.Style[this.type];["default","hover","click","drag","transition"].forEach((s=>{this.actions[s]=r.Z.paramsMerge(t[s],i[s],e[s]),e[s+"RenderCall"]&&(this.actions[s+"RenderCall"]=e[s+"RenderCall"])}));for(const e in this.actions)r.Z.observe(this.actions[e],(()=>this.isHasAction=!0));this.actionRender(E.SCENE_LIST[this.sceneId].context)}optionRender(e){this.isDrag?this.actionRender(e,"drag"):this.isClick?this.actionRender(e,"click"):this.isHover?this.actionRender(e,"hover"):this.actionRender(e)}actionRender(e,t){let i=this.actionsMerge(t);i&&(this.style=i),this[t+"Render"]&&this[t+"Render"](e),this.isHasAction=!1}actionsMerge(e){const{actions:t}=this;return t[e+"RenderCall"]?(this.actionRenderCall=t[e+"RenderCall"],null):(this.actionRenderCall=null,this.actionsParamsMerge(e))}actionsParamsMerge(e,t=!0){const{actions:i}=this;return"default"===e?r.Z.paramsMerge(i.default,t?i.change:{}):r.Z.paramsMerge(i.default,i[e],t?i.change:{})}setAlpha(e){r.Z.checkNone(this.style.alpha)&&(e.globalAlpha=this.style.alpha)}setRotate(e){let t;this.center.rotate=this.style.rotate,t=this.rotateCenter?f({},this.rotateCenter):f({},this.center),["",void 0,null].includes(t.rotate)||t.rotate%360==0||(e.translate(t.x,t.y),e.rotate(Math.PI/180*t.rotate),e.translate(-t.x,-t.y))}setShadow(e){const{shadowSize:t,shadowOffsetX:i,shadowOffsetY:r,shadowColor:s}=this.style;["",0,null,void 0].includes(t)||(e.shadowBlur=t,e.shadowOffsetX=i,e.shadowOffsetY=r,e.shadowColor=s)}backgroundRender(e){let{backgroundColor:t,imgUrl:i}=this.style;t&&(e.beginPath(),r.Z.judgeType(t)&&t.type?e.fillStyle=new u(f({context:e,el:this},t)).getColor():e.fillStyle=t,this.pathRender(e),e.fill()),i&&(this.imgRender[i]?this.loadImgData({context:e,url:i}):this.loadImg(i))}loadImgData(e){let{context:t,url:i,type:r}=e;this.imgRender[i]?(t.fillStyle="transparent",t.beginPath(),t.save(),r?this[`draw${r}`](e):this.pathRender(t),t.clip(),r?this[`drawImgBy${r}`](e):this.imageRender(t),t.restore()):this.loadImg(i)}loadImg(e){E.IMAGE_LIST[e]?this.imgRender[e]=E.IMAGE_LIST[e]:new d(e,this)}drawImgByRect({context:e,x:t,y:i,width:r,height:s,url:n}){let o=this.imgRender[n];e.drawImage(o,0,0,o.width,o.height,t,i,r,s)}drawImgByCircle({context:e,x:t,y:i,r,url:s}){let n=this.imgRender[s];e.drawImage(n,0,0,n.width,n.height,t,i,2*r,2*r)}drawRect(e){let{context:t,x:i,y:r,width:s,height:n}=e;t.rect(i,r,s,n)}drawCircle(e){let{context:t,x:i,y:r,r:s,start:n=0,end:o=2*Math.PI}=e;t.arc(i+s,r+s,s,n,o)}selectRender(e,t="blue",i=!0){const{defaultBoundaries:r}=this;if(0===r.length)return;e.beginPath(),e.save(),e.strokeStyle=t,i&&e.setLineDash([5,5,5]);let s=r[0][0],n=r[0][1],o=r[2][0]-s,l=r[2][1]-n;e.rect(s,n,o,l),e.stroke(),e.restore()}showBoundariesPoint(e){this.boundaries.forEach(((t,i)=>{e.beginPath(),e.arc(t[0],t[1],8,0,2*Math.PI),e.stroke(),new E.Elements.Text(e,t[0],t[1],{fontText:i+""})}))}showEditPoint(){if(!this.canEdit)return;this.showTestLine=!0;let{sceneId:e,editPointsR:t}=this,i=this.getEditPointsPosition();this.editPoints=i.map((({x:i,y:r,cursorStyle:s,position:n},o)=>{let l=E.SCENE_LIST[e].add({type:"EditPoint",x:i,y:r,params:{r:t,cursorStyle:s},position:n});return l.feedbackCall=this.pointFeedBack.bind(this),this.relationEl[l.id]=l,l}))}clearEditPoint(){this.canEdit&&(this.showTestLine=!1,this.editPoints.length&&(E.SCENE_LIST[this.sceneId].remove(this.editPoints),this.editPoints=[],this.relationEl={}))}getEditPointsPosition(){let{defaultBoundaries:e,editPointsR:t}=this,i=e[0],r=e[1],s=e[2],n=e[3];return[{x:i[0]-t,y:i[1]-t,cursorStyle:"lt_rb_arrow",position:"l_t"},{x:(i[0]+r[0])/2-t,y:i[1]-t,cursorStyle:"t_b_arrow",position:"t"},{x:r[0]-t,y:r[1]-t,cursorStyle:"lb_rt_arrow",position:"r_t"},{x:r[0]-t,y:(r[1]+s[1])/2-t,cursorStyle:"l_r_arrow",position:"r"},{x:s[0]-t,y:s[1]-t,cursorStyle:"lt_rb_arrow",position:"r_b"},{x:(s[0]+n[0])/2-t,y:s[1]-t,cursorStyle:"t_b_arrow",position:"b"},{x:n[0]-t,y:n[1]-t,cursorStyle:"lb_rt_arrow",position:"l_b"},{x:i[0]-t,y:(i[1]+n[1])/2-t,cursorStyle:"l_r_arrow",position:"l"}]}pointFeedBack(e,t,i){let r,s={l:{x:t,y:0,width:-t,height:0},r:{x:0,y:0,width:t,height:0},t:{x:0,y:i,width:0,height:-i},b:{x:0,y:0,width:0,height:i}},n=e.CONFIG.position;r=n.indexOf("_")>-1?n.split("_"):[n],r.forEach((e=>{for(const t in s[e])this[t]+=s[e][t]})),this.judgeBoundaries&&this.judgeBoundaries();let o=this.getEditPointsPosition();this.editPoints.forEach((e=>{let t=o.find((t=>t.position===e.CONFIG.position));e.x=t.x,e.y=t.y}));let l=E.SCENE_LIST[this.sceneId];l.editCall&&l.editCall(e,t,i,this)}preRender(e){this.textRender(e),this.borderRender(e)}textRender(e){let{center:t,defaultBoundaries:i,style:r}=this;if(r.fontIcon||r.fontText){let s=t.x,n=t.y;new E.Elements.Text(e,s,n,r,i)}}borderRender(e){let{style:t}=this;if(r.Z.judgeType(t.borderSize,1)&&t.borderSize){if(e.save(),e.beginPath(),"dashed"===t.borderType){let i=5;r.Z.judgeType(t.borderDashedSpace,1)&&(i=t.borderDashedSpace),e.setLineDash([i,i,i])}e.strokeStyle=t.borderColor||"black",e.lineWidth=t.borderSize,this.pathRender(e),e.stroke(),e.restore()}}arrowRender(e){let{style:t,points:i}=this,s=(t.lineWidth||0)/2;e.save(),e.beginPath();const n=i[i.length-1],o=i[i.length-2];let{arrowSize:l,arrowColor:a}=t;e.translate(n.x,n.y);let h=r.Z.judgeAngle(o,n)-(n.x-o.x>=0?180:0);e.rotate(h*Math.PI/180),e.moveTo(-1,0),e.lineTo(1.6*l,-s-l),e.lineTo(1.6*l,s+l),e.closePath(),e.fillStyle=a,e.fill(),e.translate(-n.x,-n.y),e.restore()}setGradient(){}animationsRender(){for(const e in this.animations)this.animations[e].isRender&&(["x","y","width","height","r"].includes(e)?(this[e]=this.animations[e].render(this[e]),this.judgeBoundaries&&this.judgeBoundaries()):(this.actions.change[e]=this.animations[e].render(this.actions.change[e]),this.style[e]=this.actions.change[e],["rotate"].includes(e)&&this.judgeBoundaries&&this.judgeBoundaries()))}setAnimations(e){for(const t in e)this.animations[t]=new c(e[t],t,this.sceneId)}removeAnimations(e){r.Z.judgeType(e,4)?e.forEach((e=>delete this.animations[e])):r.Z.judgeType(e,0)&&delete this.animations[e]}elementMouseStyleHandler(e){let{cursorStyle:t,disabled:i,canHover:r,canDrag:s}=this;if(i)return"disabled";if(t)return t;switch(e){case"drag":return s?"drag":"default";case"hover":return r?"hover":"default"}}clearAnimation(){this.animations={}}setBoundaries(e,t,i,s){this.defaultBoundaries=[[e,i],[t,i],[t,s],[e,s]],this.center.x=(e+t)/2,this.center.y=(i+s)/2;let n=this.style.rotate;if(["",void 0,null].includes(n)||n%360==0)this.boundaries=[[e,i],[t,i],[t,s],[e,s]];else{let{center:o,defaultBoundaries:l}=this,a=Math.sqrt(Math.pow(e-t,2)+Math.pow(i-s,2))/2;this.boundaries=l.map(((e,t)=>{let i={x:e[0],y:e[1]},s=r.Z.judgeAngle(o,i);switch(t){case 0:case 3:s+=90;break;case 1:case 2:s+=270}s+=n;let l=r.Z.judgeXY(-s%360,o,a);return[l.x,l.y]}))}}judgeValueIsInRange(e,t){const{offsetX:i,offsetY:r}=e;return this.pathRender&&(t.save(),this.setRotate(t),t.beginPath(),this.pathRender(t),t.restore()),t.isPointInPath(i,r)}elOffset(e){if(!this.disabled&&this.canDrag){const{offsetX:t,offsetY:i}=e;let{scale:r,sceneId:s}=this,n=E.SCENE_LIST[s].mouseOldPosition,o=(t-n.offsetX)/r,l=(i-n.offsetY)/r;["EditPoint"].includes(this.type)||(this.x+=o,this.y+=l),this.judgeBoundaries&&!this.parent&&this.judgeBoundaries(),this.changeAllPoints&&this.changeAllPoints(-o,-l),this.feedbackCall&&this.feedbackCall(this,o,l);for(const t in this.relationEl){let i=this.relationEl[t];i.relationChange&&i.relationChange(this,e)}}}judgeIsInSceneViewArea(){const{x1:e,x2:t,y1:i,y2:r}=E.SCENE_LIST[this.sceneId].viewArea,{defaultBoundaries:s}=this;4===s.length&&(this.canRender=e<=s[2][0]&&i<=s[2][1]&&t>=s[0][0]&&r>=s[0][1])}destroy(){}setActions(e,t,i="default"){this.actions[i][e]=t,this.actions.change[e]=t}}class m extends g{constructor(e){super(e);let{width:t,height:i}=e.params;this.width=t,this.height=i,this.parent||this.judgeBoundaries()}pathRender(e){let{x:t,y:i,width:r,height:s}=this;this.drawRect({context:e,x:t,y:i,width:r,height:s})}imageRender(e){let{x:t,y:i,width:r,height:s}=this,n=this.style.imgUrl;this.drawImgByRect({context:e,x:t,y:i,width:r,height:s,url:n})}judgeBoundaries(){let e,t,i,r,{x:s,y:n,width:o,height:l}=this;e=s,t=s+o,i=n,r=n+l,this.setBoundaries(e,t,i,r)}}class p extends g{constructor(e){super(e);let{r:t=0,start:i=0,end:r=2*Math.PI}=e.params;this.r=t,this.start=i,this.end=r,this.parent||this.judgeBoundaries()}pathRender(e){let{x:t,y:i,r,start:s,end:n}=this;this.drawCircle({context:e,x:t,y:i,r,start:s,end:n})}imageRender(e){let{x:t,y:i,r}=this,s=this.style.imgUrl;this.drawImgByCircle({context:e,x:t,y:i,r,url:s})}judgeBoundaries(){let e,t,i,r,{x:s,y:n,r:o}=this;e=s,t=s+2*o,i=n,r=n+2*o,this.setBoundaries(e,t,i,r)}}const v={Rect:m,Circle:p,Text:class{constructor(e,t,i,r,s){this.x=t||0,this.y=i||0,this.style=r||{},this.boundaries=s||[],this.render(e)}render(e){let{fontSize:t=E.Style.Text.default.fontSize,fontColor:i="black",fontIcon:s,fontClass:n,fontText:o,fontAlign:l,fontOffsetX:a,fontOffsetY:h}=this.style;if(a=r.Z.judgeType(a,1)?a:0,h=r.Z.judgeType(h,1)?h:0,e.save(),e.fillStyle=i,s){e.textAlign=l||"center",e.textBaseline="middle";let{x:i,y:r}=this;n="FontAwesome",e.font=`${t}px ${n}`,e.fillText(this.createFontIcon(s),i+a,r+h)}if(!s&&o){e.textBaseline="middle",n="sans-serif",e.font=`${t}px ${n}`;let{x:i,y:r,fontHeight:s,position:c,textAlign:d}=this.setTextPosition(e);if(e.textAlign=l||d,o.indexOf("\r\n")>-1){const n=o.split("\r\n");if("top"===c)n.forEach(((o,l)=>{e.fillText(o,i+a,r-(n.length-.5-l)*t+s/2+h)}));else if("bottom"===c)n.forEach(((n,o)=>{e.fillText(n,i+a,r+(o+.5)*t+s/2+h)}));else if(n.length%2==0){let o=n.length/2;n.forEach(((n,l)=>{l===o?e.fillText(n,i+a,r+.5*t+s/2+h):e.fillText(n,i+a,r-(o-l-.5)*t+s/2+h)}))}else{let o=Math.floor(n.length/2);n.forEach(((n,l)=>{l===o?e.fillText(n,i+a,r+s/2+h):e.fillText(n,i+a,r-(o-l)*t+s/2+h)}))}}else"top"===c?e.fillText(o,i+a,r-t/2+h):"bottom"===c?e.fillText(o,i+a,r+s+t/2+h):e.fillText(o,i+a,r+s/2+h)}e.restore()}createFontIcon(e){return this.font=document.createElement("i"),this.font.innerHTML=e,this.font.textContent}setTextPosition(e){let{x:t,y:i,boundaries:r}=this,{fontPosition:s,fontText:n}=this.style,{actualBoundingBoxDescent:o}=e.measureText(n),l=o/2;if(0===r.length)return{x:t,y:i,fontHeight:l,position:"center",textAlign:"center"};let a=(r[2][0]-r[0][0])/2,h=(r[2][1]-r[0][1])/2;switch(s){case"top":return{x:t,y:i-h,fontHeight:l,position:"top",textAlign:"center"};case"top-left":return{x:t-a,y:i-h,fontHeight:l,position:"top",textAlign:"right"};case"top-right":return{x:t+a,y:i-h,fontHeight:l,position:"top",textAlign:"left"};case"center":return{x:t,y:i,fontHeight:l,position:"center",textAlign:"center"};case"center-left":return{x:t-a,y:i,fontHeight:l,position:"center",textAlign:"right"};case"center-right":return{x:t+a,y:i,fontHeight:l,position:"center",textAlign:"left"};case"bottom":return{x:t,y:i+h,fontHeight:l,position:"bottom",textAlign:"center"};case"bottom-left":return{x:t-a,y:i+h,fontHeight:l,position:"bottom",textAlign:"right"};case"bottom-right":return{x:t+a,y:i+h,fontHeight:l,position:"bottom",textAlign:"left"}}return{x:t,y:i,fontHeight:l,position:"center",textAlign:"center"}}},StraightLine:class extends g{constructor(e){super(e);let{points:t=[],start:i,end:r}=e.params;this.points=t,this.start=i,this.end=r,this.canDrag=!1,this.canEdit=!1,this.start&&this.end&&(this.start.relationEl[this.id]=this,this.end.relationEl[this.id]=this,this.setAutoPath()),this.judgeBoundaries()}otherRender(e){let{points:t,showTestLine:i,style:r}=this,{lineWidth:s,lineColor:n,lineDash:o,lineCap:l}=r;void 0===t||t.length<2||(e.beginPath(),e.save(),e.setLineDash(o||[]),e.strokeStyle=n||"black",e.lineWidth=s||1,e.lineCap=l||"butt",e.moveTo(t[0].x,t[0].y),e.lineTo(t[1].x,t[1].y),this.optionRender(e),e.stroke(),e.restore(),i&&(e.beginPath(),this.pathRender(e),e.stroke()))}pathRender(e){const{points:t,style:i}=this;if(void 0===t||t.length<2)return;let r=(i.lineWidth||0)/2+3;const s=t.length-1;for(let i=0;i<t.length;i++)if([s,0].includes(i))0===i?t[0].x===t[1].x?(e.moveTo(t[0].x-r,t[0].y),e.lineTo(t[0].x+r,t[0].y)):e.moveTo(t[0].x,t[0].y-r):t[s].x===t[s-1].x?e.lineTo(t[s].x+r,t[s].y):e.lineTo(t[s].x,t[s].y-r);else{const s=t[i].x===t[i-1].x,n=t[i].x===t[i+1].x,o=t[i].y>t[i-1].y,l=t[i].y>t[i+1].y;if(s||n){o?e.lineTo(t[i].x+r,t[i].y-r):e.lineTo(t[i].x-r,t[i].y-r),l?e.lineTo(t[i].x-r,t[i].y-r):e.lineTo(t[i].x+r,t[i].y-r);continue}e.lineTo(t[i].x,t[i].y-r)}for(let i=s;i>=0;i--)if([s,0].includes(i))0===i?t[0].x===t[1].x?e.lineTo(t[0].x-r,t[0].y):(e.lineTo(t[0].x,t[0].y+r),e.lineTo(t[0].x,t[0].y-r)):t[s].x===t[s-1].x?e.lineTo(t[s].x-r,t[s].y):(e.lineTo(t[s].x,t[s].y-r),e.lineTo(t[s].x,t[s].y+r));else{const s=t[i].x===t[i-1].x,n=t[i].x===t[i+1].x,o=(t[i].y,t[i-1].y,t[i].y>t[i+1].y);if(s||n){e.lineTo(t[i].x-r,t[i].y+r),o?e.lineTo(t[i].x+r,t[i].y+r):e.lineTo(t[i].x-r,t[i].y+r);continue}e.lineTo(t[i].x,t[i].y+r)}}preRender(e){this.textRender(e),this.arrowRender(e)}relationChange(){this.setAutoPath()}setAutoPath(){let e=this.start.center.x,t=this.start.center.y,i=this.end.center.x,r=this.end.center.y;this.points=[{x:e,y:t},{x:i,y:r}]}judgeBoundaries(){const{points:e}=this,t=e.map((e=>e.x)),i=e.map((e=>e.y)),r=Math.min(...t),s=Math.max(...t),n=Math.min(...i),o=Math.max(...i);this.setBoundaries(r,s,n,o)}},BrokenLine:class extends g{constructor(e){super(e);let{points:t=[],start:i=null,end:r=null,isAutoPath:s=!0,minBrokenWidth:n=15,editPointsR:o=4}=e.params;this.points=t,this.start=i,this.end=r,this.isAutoPath=!(t.length>=2)&&s,this.minBrokenWidth=n,this.editPointsR=o,this.canDrag=!1,this.start&&this.end?(this.start.relationEl[this.id]=this,this.end.relationEl[this.id]=this,this.isAutoPath?this.setAutoPath():this.judgeBoundaries()):this.judgeBoundaries()}otherRender(e){let{points:t,showTestLine:i,style:r}=this,{lineWidth:s,lineColor:n,lineDash:o,lineCap:l}=r;if(!(void 0===t||t.length<2)){e.beginPath(),e.save(),e.setLineDash(o||[]),e.strokeStyle=n||"black",e.lineWidth=s||1,e.lineCap=l||"butt",e.moveTo(t[0].x,t[0].y);for(let i=1;i<t.length;i++)e.lineTo(t[i].x,t[i].y);this.optionRender(e),e.stroke(),e.restore(),i&&(e.beginPath(),this.pathRender(e),e.stroke())}}pathRender(e){const{points:t,style:i}=this;if(void 0===t||t.length<2)return;const r=t.length-1;let s=(i.lineWidth||0)/2+3;for(let i=0;i<t.length;i++){let{direction:n}=t[i];if(0===i)e.moveTo(t[i].x,t[i].y+s),e.lineTo(t[i].x,t[i].y-s);else if(1===i)e.lineTo(t[i].x-s,t[i].y-s),["left","bottom"].includes(n.next)&&e.lineTo(t[i].x+s,t[i].y-s),"left"===n.next&&e.lineTo(t[i].x+s,t[i].y+s);else if(i===r-1)"right"===n.prev&&e.lineTo(t[i].x-s,t[i].y+s),["right","bottom"].includes(n.prev)&&e.lineTo(t[i].x-s,t[i].y-s),e.lineTo(t[i].x+s,t[i].y-s);else if(i===r)e.lineTo(t[i].x-s,t[i].y-s),e.lineTo(t[i].x-s,t[i].y+s);else{let{prev:r,next:o}=n;"left"===r&&"top"===o&&e.lineTo(t[i].x-s,t[i].y-s),"left"===r&&"bottom"===o&&e.lineTo(t[i].x+s,t[i].y-s),"right"===r&&"top"===o&&e.lineTo(t[i].x-s,t[i].y+s),"right"===r&&"bottom"===o&&e.lineTo(t[i].x+s,t[i].y+s),"top"===r&&"left"===o&&e.lineTo(t[i].x+s,t[i].y+s),"top"===r&&"right"===o&&e.lineTo(t[i].x+s,t[i].y-s),"bottom"===r&&"left"===o&&e.lineTo(t[i].x-s,t[i].y+s),"bottom"===r&&"right"===o&&e.lineTo(t[i].x-s,t[i].y-s)}}for(let i=r;i>=0;i--){let{direction:n}=t[i];if(0===i)e.lineTo(t[i].x,t[i].y+s);else if(1===i)"left"===n.next&&e.lineTo(t[i].x+s,t[i].y-s),["left","top"].includes(n.next)&&e.lineTo(t[i].x+s,t[i].y+s),e.lineTo(t[i].x-s,t[i].y+s);else if(i===r-1)e.lineTo(t[i].x+s,t[i].y+s),["right","top"].includes(n.prev)&&e.lineTo(t[i].x-s,t[i].y+s),"right"===n.prev&&e.lineTo(t[i].x-s,t[i].y-s);else if(i===r)e.lineTo(t[i].x-s,t[i].y+s);else{let{prev:r,next:o}=n;"left"===r&&"top"===o&&e.lineTo(t[i].x+s,t[i].y+s),"left"===r&&"bottom"===o&&e.lineTo(t[i].x-s,t[i].y+s),"right"===r&&"top"===o&&e.lineTo(t[i].x+s,t[i].y-s),"right"===r&&"bottom"===o&&e.lineTo(t[i].x-s,t[i].y-s),"top"===r&&"left"===o&&e.lineTo(t[i].x-s,t[i].y-s),"top"===r&&"right"===o&&e.lineTo(t[i].x-s,t[i].y+s),"bottom"===r&&"left"===o&&e.lineTo(t[i].x+s,t[i].y-s),"bottom"===r&&"right"===o&&e.lineTo(t[i].x+s,t[i].y+s)}}}preRender(e){this.textRender(e),this.arrowRender(e)}changeAllPoints(e,t){this.points.forEach((i=>{i.x-=e,i.y-=t}))}relationChange(){this.showTestLine=!1,this.clearEditPoint(),this.setAutoPath()}setAutoPath(){let e=this.start.center.x,t=this.start.center.y,i=this.end.center.x,r=this.end.center.y,s=1;if(e>i&&(s=-1),e===i&&(s=1),e===i||t===r)this.points=[{x:e,y:t},{x:e+this.minBrokenWidth*s,y:t},{x:i-this.minBrokenWidth*s,y:r},{x:i,y:r}];else{let n=(e+i)/2;this.points=[{x:e,y:t},{x:e+this.minBrokenWidth*s,y:t},{x:n,y:t},{x:n,y:r},{x:i-this.minBrokenWidth*s,y:r},{x:i,y:r}]}this.judgeBoundaries()}addEditPoint(e,t,i){this.points.splice(e,0,{x:t+this.editPointsR,y:i+this.editPointsR});let s=E.SCENE_LIST[this.sceneId].add({type:"EditPoint",x:t,y:i,params:{r:this.editPointsR,cursorStyle:"t_b_arrow"}});s.feedbackCall=this.pointFeedBack.bind(this),this.editPoints.splice(e,0,s),this.editPoints.forEach(((e,t)=>r.Z.setDirection.call(e,this.editPoints,t)))}removeEditPoint(e){this.points.splice(e,1),E.SCENE_LIST[this.sceneId].remove([this.editPoints[e]]),this.editPoints.splice(e,1),this.editPoints.forEach(((e,t)=>r.Z.setDirection.call(e,this.editPoints,t)))}showEditPoint(){this.isShowEditPoint=!0;let{sceneId:e,points:t,editPointsR:i}=this;this.editPoints=t.map((({x:r,y:s},n)=>{let o=E.SCENE_LIST[e].add({type:"EditPoint",x:r-i,y:s-i,params:{r:i,cursorStyle:"move"}});return[0,1,t.length-2,t.length-1].includes(n)&&(o.disabled=!0,o.canDrag=!1),o.feedbackCall=this.pointFeedBack.bind(this),o})),this.editPoints.forEach(((e,t)=>r.Z.setDirection.call(e,this.editPoints,t)))}clearEditPoint(){this.canEdit&&this.editPoints.length&&(E.SCENE_LIST[this.sceneId].remove(this.editPoints),this.editPoints=[])}pointFeedBack(e,t,i){let r=e.index,s=!["top","bottom"].includes(this.editPoints[r].direction.prev),n=!["top","bottom"].includes(this.editPoints[r].direction.next);s&&2===this.editPoints[r].judgeStartOrEndLength("prev")&&Math.floor(Math.abs(this.editPoints[r].y-this.editPoints[r-1].y))<=Math.floor(Math.abs(i))&&(this.addEditPoint(r,this.editPoints[r-1].x,this.editPoints[r-1].y),r++),n&&2===this.editPoints[r].judgeStartOrEndLength("next")&&Math.floor(Math.abs(this.editPoints[r].y-this.editPoints[r+1].y))<=Math.floor(Math.abs(i))&&this.addEditPoint(r+1,this.editPoints[r+1].x,this.editPoints[r+1].y);let{points:o}=this,l=r-1,a=r+1,h=1,c=o.length-2,d=o[l],u=o[a],f=o[r];["left","right"].includes(this.editPoints[r].direction.prev)?([c].includes(a)||(f.x+=t,this.editPoints[r].x+=t),[h,c].includes(l)||(d.y+=i,this.editPoints[l].y+=i)):["top","bottom"].includes(this.editPoints[r].direction.prev)&&(f.y+=i,this.editPoints[r].y+=i,[h,c].includes(l)||(d.x+=t,this.editPoints[l].x+=t)),["left","right"].includes(this.editPoints[r].direction.next)?([h].includes(l)||(f.x+=t,this.editPoints[r].x+=t),[h,c].includes(a)||(u.y+=i,this.editPoints[a].y+=i)):["top","bottom"].includes(this.editPoints[r].direction.next)&&(f.y+=i,this.editPoints[r].y+=i,[h,c].includes(a)||(u.x+=t,this.editPoints[a].x+=t)),this.judgeBoundaries()}judgeBoundaries(){const{points:e}=this;if(e.forEach(((t,i)=>r.Z.setDirection.call(t,e,i))),e.length<2)return;const t=e.map((e=>e.x)),i=e.map((e=>e.y)),s=Math.min(...t),n=Math.max(...t),o=Math.min(...i),l=Math.max(...i);this.boundaries=[[s,o],[n,o],[n,l],[s,l]],this.center.x=(s+n)/2,this.center.y=(o+l)/2}},EditPoint:class extends p{constructor(e){super(e),this.canClick=!1,this.isTransition=!1}judgeStartOrEndLength(e,t=0){return["prev","next"].includes(e)?(null!==this[e]&&(t+=this[e].judgeStartOrEndLength(e,t),t++),t):null}relationChange(e,t){const{offsetX:i,offsetY:r}=t;let{scale:s,sceneId:n}=this,o=E.SCENE_LIST[n].mouseOldPosition,l=(i-o.offsetX)/s,a=(r-o.offsetY)/s;this.x+=l,this.y+=a}},SelectBorder:class extends m{constructor(e){super(e)}setSize(e,t){this.width=e,this.height=t,this.judgeBoundaries()}clearRelationEl(){for(const e in this.relationEl){let t=this.relationEl[e];t.isSelect=!1,t.relationChange=null}}},Other:class extends g{constructor(e){super(e),r.Z.setConfig.call(this,e)}},Container:class extends g{constructor(e){super(e);let{width:t,height:i}=e.params;this.width=t,this.height=i,this.children=[],e.children&&e.children instanceof Array&&e.children.forEach((e=>this.add(e))),this.hoverEl=null,this.clickEl=null,this.judgeBoundaries()}pathRender(e){let{x:t,y:i,width:r,height:s}=this;e.rect(t,i,r,s)}imageRender(e){let{x:t,y:i,width:r,height:s}=this;e.drawImage(this.imgRender,0,0,this.imgRender.width,this.imgRender.height,t,i,r,s)}checkChildren(e){return this.children.length>0?this.judgeHasElementInMouseRange(e):null}childrenHoverCall(e){if(this.disabled)return;if(!this.canHover)return;let t=this.checkChildren(e),i=E.SCENE_LIST[this.sceneId];t?(t.isHover=!0,this.hoverEl?this.judgeIsSameEl(t,"hover")||(!this.hoverEl.disabled&&this.hoverEl.canHover&&i.leaveCall&&i.leaveCall(i.mouseMoveEvent,this.hoverEl),this.hoverEl.isHover=!1,this.hoverEl=t,i.canvasFront.classList=[i.cursorClass[t.elementMouseStyleHandler("hover")]],!t.disabled&&t.canHover&&i.hoverCall&&i.hoverCall(i.mouseMoveEvent,t)):(this.hoverEl=t,i.canvasFront.classList=[i.cursorClass[t.elementMouseStyleHandler("hover")]],!t.disabled&&t.canHover&&i.hoverCall&&i.hoverCall(i.mouseMoveEvent,t))):this.hoverEl&&(this.hoverEl.isHover=!1,!this.hoverEl.disabled&&this.hoverEl.canHover&&i.leaveCall&&i.leaveCall(i.mouseMoveEvent,this.hoverEl),this.hoverEl=null,i.canvasFront.classList=[i.cursorClass[this.elementMouseStyleHandler("hover")]],i.hoverCall&&i.hoverCall(i.mouseMoveEvent,this))}childrenClickCall(e,t){if(this.disabled)return;if(!this.canClick)return;let i=this.checkChildren(e),r=E.SCENE_LIST[this.sceneId];t?(r.clickEl=this,i?(i.isClick=!0,this.clickEl=i,!i.disabled&&i.canClick&&r.clickCall&&r.clickCall(r.mouseMoveEvent,i)):(this.isClick=!0,r.clickCall&&r.clickCall(r.mouseMoveEvent,this))):i?this.clickEl?(!this.clickEl.disabled&&this.clickEl.canClick&&r.cancelCall&&r.cancelCall(r.mouseMoveEvent,this.clickEl),this.judgeIsSameEl(i,"click")?(this.clickEl.isClick=!1,this.clickEl=null,r.cancelCall&&r.cancelCall(r.mouseMoveEvent,this),r.clickEl=null):(this.clickEl.isClick=!1,i.isClick=!0,this.clickEl=i,!i.disabled&&i.canClick&&r.clickCall&&r.clickCall(r.mouseMoveEvent,i))):(r.cancelCall&&r.cancelCall(r.mouseMoveEvent,this),i.isClick=!0,this.clickEl=i,!i.disabled&&i.canClick&&r.clickCall&&r.clickCall(r.mouseMoveEvent,i)):this.clickEl?(this.isClick=!0,this.clickEl.isClick=!1,!this.clickEl.disabled&&this.clickEl.canClick&&r.cancelCall&&r.cancelCall(r.mouseMoveEvent,this.clickEl),this.clickEl=null,r.clickCall&&r.clickCall(r.mouseMoveEvent,this)):(this.isClick=!1,r.cancelCall&&r.cancelCall(r.mouseMoveEvent,this),r.clickEl=null)}childrenDragCall(e,t){this.canEvent&&(this.disabled||this.canDrag&&(t?this.children.forEach((e=>e.isDrag=!0)):this.children.forEach((e=>e.isDrag=!1))))}childrenOtherClickCall(e){return this.checkChildren(e)||this}judgeIsSameEl(e,t){let i=!1;return this[`${t}El`]&&(i=e.id===this[`${t}El`].id),i}judgeHasElementInMouseRange(e){let t=E.SCENE_LIST[this.sceneId].mouseMoveEvent;e.save(),this.setRotate(e);const i=this.children.filter((i=>i.canEvent&&i.judgeValueIsInRange(t,e)));return e.restore(),i.length?(i.sort(((e,t)=>t.renderZIndex-e.renderZIndex)),i[0]):null}judgeBoundaries(){let e,t,i,s,{x:n,y:o,width:l,height:a,children:h}=this;e=n,t=n+l,i=o,s=o+a,this.setBoundaries(e,t,i,s),h.forEach((e=>{let{x:t,y:i,params:s}=e.CONFIG;r.Z.judgeType(t,0)?e.x=this.x+r.Z.evalMathStr(t,this.width):e.x=this.x+t,r.Z.judgeType(i,0)?e.y=this.y+r.Z.evalMathStr(i,this.height):e.y=this.y+i,r.Z.judgeType(s.width,0)?e.width=r.Z.evalMathStr(s.width,this.width):e.width=s.width,r.Z.judgeType(s.height,0)?e.height=r.Z.evalMathStr(s.height,this.height):e.height=s.height,e.judgeBoundaries()&&e.judgeBoundaries();for(const t in e.relationEl){let i=e.relationEl[t];i.relationChange&&i.relationChange(e)}}))}add(e){let{children:t}=this;e.id||(e.id=r.Z.getUUID("view_canvas_el_child:")),e.sceneId=this.sceneId,e.parent=this,e.zIndex=t.length;let i=new E.Elements[e.type](e);i.canEdit=!1,t.push(i)}remove(e){}removeAll(){}find(e){}findAll(){}childrenRender(e){let{scale:t,oX:i,oY:r,children:s}=this;0!==s.length&&s.forEach((s=>{s.isSelect=!1,s.render(e,t,i,r)}))}},Input:class extends m{constructor(e){super(e),this.createControl()}createControl(){const{id:e,sceneId:t}=this;let i=E.SCENE_LIST[t].parent,r=document.createElement("input");r.id=e,r.placeholder="请输入...",i.appendChild(r),this.setControl()}setControl(){const{id:e,x:t,y:i,width:r,height:s,oX:n,oY:o,scale:l,isClick:a}=this;let h=document.getElementById(e);h.style.display=a?"inline-block":"none",h.style.textAlign="center",h.style.background="transparent",h.style.border="1px dotted black",h.style.position="absolute",h.style.zIndex="9999",h.style.width=((r||120)-20)*l+"px",h.style.height=((s||40)-20)*l+"px",h.style.top=`${((i||120)+10)*l+o}px`,h.style.left=`${((t||120)+10)*l+n}px`}eventCall(e,t){if("click"===e)if(t)this.actions.default.fontText="";else{let e=document.getElementById(this.id);this.actions.default.fontText=e.value||"请输入..."}}preRender(e){this.setControl(),this.textRender(e)}destroy(){let e=document.getElementById(this.id);E.SCENE_LIST[this.sceneId].parent.removeChild(e)}},Img:d},y=v,b=JSON.parse('{"default":{"backgroundColor":"black","imgUrl":"","rotate":"","alpha":"","fontText":"","fontIcon":"","fontColor":"white","fontClass":"","fontSize":12,"fontAlign":"center","fontPosition":"center","fontOffsetX":0,"fontOffsetY":0,"borderSize":0,"borderColor":"red","borderType":"","borderDashedSpace":"","shadowSize":"","shadowOffsetX":0,"shadowOffsetY":0,"shadowColor":"black","lineWidth":1,"lineColor":"#F56C6C","lineDash":"","lineCap":"","arrowSize":4,"arrowColor":"#F56C6C"},"hover":{"backgroundColor":"","imgUrl":"","rotate":"","alpha":"","fontText":"","fontIcon":"","fontColor":"","fontClass":"","fontSize":"","fontAlign":"","fontPosition":"","fontOffsetX":0,"fontOffsetY":0,"borderSize":"","borderColor":"","borderType":"","borderDashedSpace":"","shadowSize":10,"shadowOffsetX":0,"shadowOffsetY":0,"shadowColor":"","lineWidth":"","lineColor":"","lineDash":"","lineCap":"","arrowSize":6,"arrowColor":""},"click":{"backgroundColor":"","imgUrl":"","rotate":"","alpha":"","fontText":"","fontIcon":"","fontColor":"","fontClass":"","fontSize":14,"fontAlign":"","fontPosition":"","fontOffsetX":0,"fontOffsetY":0,"borderSize":"","borderColor":"","borderType":"","borderDashedSpace":"","shadowSize":15,"shadowOffsetX":0,"shadowOffsetY":0,"shadowColor":"","lineWidth":"","lineColor":"","lineDash":"","lineCap":"","arrowSize":6,"arrowColor":""},"drag":{"backgroundColor":"","imgUrl":"","rotate":"","alpha":"","fontText":"","fontIcon":"","fontColor":"","fontClass":"","fontSize":"","fontAlign":"","fontPosition":"","fontOffsetX":0,"fontOffsetY":0,"borderSize":"","borderColor":"","borderType":"","borderDashedSpace":"","shadowSize":15,"shadowOffsetX":0,"shadowOffsetY":0,"shadowColor":"","lineWidth":"","lineColor":"","lineDash":"","lineCap":"","arrowSize":6,"arrowColor":""},"transition":{"backgroundColor":0.18,"rotate":0.18,"alpha":0.18,"fontSize":0.18,"fontColor":0.18,"borderSize":0.18,"borderColor":0.18,"shadowSize":0.18,"shadowOffsetX":0.18,"shadowOffsetY":0.18,"shadowColor":0.18,"lineWidth":0.18,"lineColor":0.18,"arrowSize":0.18,"arrowColor":0.18}}'),w=JSON.parse('{"default":{"backgroundColor":"","imgUrl":"","fontText":"","fontIcon":"","fontClass":"","fontSize":12,"fontPosition":"","borderSize":"","borderColor":"","borderType":"","shadowSize":0,"shadowOffsetX":"","shadowOffsetY":"","shadowColor":"","lineWidth":"","lineColor":"","lineDash":"","lineCap":""}}'),x=JSON.parse('{"default":{"backgroundColor":"","imgUrl":"","fontText":"","fontIcon":"","fontClass":"","fontSize":12,"fontPosition":"","borderSize":"","borderColor":"","borderType":"","shadowSize":"","shadowOffsetX":"","shadowOffsetY":"","shadowColor":"","lineWidth":"","lineColor":"","lineDash":"","lineCap":""}}'),C={Element:b,Rect:w,Circle:JSON.parse('{"default":{"backgroundColor":"","imgUrl":"","fontText":"","fontIcon":"","fontClass":"","fontSize":"","fontPosition":"","borderSize":"","borderColor":"","borderType":"","shadowSize":"","shadowOffsetX":"","shadowOffsetY":"","shadowColor":"","lineWidth":"","lineColor":"","lineDash":"","lineCap":""}}'),Container:JSON.parse('{"default":{"backgroundColor":"transparent"}}'),StraightLine:JSON.parse('{"default":{"backgroundColor":"","imgUrl":"","fontText":"","fontIcon":"","fontClass":"","fontSize":"","fontPosition":"","borderSize":"","borderColor":"","borderType":"","shadowSize":"","shadowOffsetX":"","shadowOffsetY":"","shadowColor":"","lineWidth":"","lineColor":"","lineDash":"","lineCap":""}}'),BrokenLine:JSON.parse('{"default":{"shadowSize":0},"hover":{"shadowSize":1},"click":{"shadowSize":2},"drag":{"shadowSize":2}}'),Text:x,EditPoint:JSON.parse('{"default":{"backgroundColor":"#3399ff"},"hover":{"backgroundColor":"#ff9900"},"click":{"backgroundColor":"#ff9900"},"drag":{"backgroundColor":"#ff9900"}}'),SelectBorder:JSON.parse('{"default":{"backgroundColor":"rgba(0,0,0,.4)","borderSize":2,"borderColor":"red"}}'),Input:JSON.parse('{"default":{"backgroundColor":"transparent","fontText":"请输入...","fontColor":"black"}}')};class E{}E.IMAGE_LIST={},E.VIDEO_LIST={},E.SCENE_LIST={},E.MODE={DEFAULT:[1,1,0,0,0,0],EDIT:[1,1,1,1,1,0],DRAG:[1,1,1,0,0,0],MOVE:[1,1,0,1,0,0],ZOOM:[1,1,0,0,1,0],SELECT:[1,1,1,0,1,1],PREVIEW:[1,1,0,1,1,0],FREEZE:[0,0,0,0,0,0]},E.Tool=r.Z,E.Stage=class{constructor(e,t){console.warn("view-----start"),this.parent=e,e.style.position="relative",e.style.overflow="hidden",this.params=t,this.sceneList=[],this.currentScene=null,this.sceneLimitNum=999,this.useRightMenu=!0,this.createScene("default"),this.switchScene("default"),this.eventListener()}eventListener(){let e=this;this.resizeObserver=new ResizeObserver((()=>{e.sceneList.forEach((e=>{e.isResize&&e.resizeView()}))})),this.resizeObserver.observe(this.parent)}createScene(e,t={}){if(this.sceneList.length>=this.sceneLimitNum)return void alert("已达到创建场景上限，无法继续创建！");let{parent:i,params:r}=this,{config:s,handler:n}=r,o=this.sceneList.length+1,l=new a({parent:i,config:Object.assign(s||{},t),handler:n,name:e,zIndex:o});return this.sceneList.push(l),E.SCENE_LIST[l.id]=l,l}getScene(e){return this.sceneList.find((t=>t.name===e))}getSceneIndex(e){return this.sceneList.findIndex((t=>t.name===e))}switchScene(e){this.currentScene=this.sceneList.find((t=>t.name===e)),this.sceneList.forEach((e=>{e.beforeFreezeMode||(e.beforeFreezeMode=[...e.mode]),e.setSceneMode(E.MODE.FREEZE),e.renderZIndex=e.defaultZIndex})),this.currentScene.setSceneMode(this.currentScene.beforeFreezeMode),this.currentScene.beforeFreezeMode=null,this.currentScene.renderZIndex=1e3,this.currentScene.setSceneZIndex(),this.currentScene.canvasFront.focus()}removeScene(e){let t=this.sceneList.findIndex((t=>t.name===e)),i=this.sceneList[t].destroyScene();delete E.SCENE_LIST[i],this.parent.removeChild(this.sceneList[t].canvasFront),this.sceneList.splice(t,1)}addEl(e,t="element",i="currentScene"){let r=h({},e);return this[i].add(r,t)}removeEl(e){let{sceneId:t}=e;E.SCENE_LIST[t].remove(e)}destroy(){this.sceneList.forEach((e=>{let t=e.destroyScene();delete E.SCENE_LIST[t]})),this.resizeObserver.unobserve(this.parent),this.resizeObserver=null,this.sceneList=[],this.parent.innerHTML="",console.warn("view-----destroy")}},E.Element=g,E.Elements=y,E.Style=C,window.View=E},168:(e,t,i)=>{var r=i(874),s={};for(var n in r)r.hasOwnProperty(n)&&(s[r[n]]=n);var o=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in o)if(o.hasOwnProperty(l)){if(!("channels"in o[l]))throw new Error("missing channels property: "+l);if(!("labels"in o[l]))throw new Error("missing channel labels property: "+l);if(o[l].labels.length!==o[l].channels)throw new Error("channel and label counts mismatch: "+l);var a=o[l].channels,h=o[l].labels;delete o[l].channels,delete o[l].labels,Object.defineProperty(o[l],"channels",{value:a}),Object.defineProperty(o[l],"labels",{value:h})}o.rgb.hsl=function(e){var t,i,r=e[0]/255,s=e[1]/255,n=e[2]/255,o=Math.min(r,s,n),l=Math.max(r,s,n),a=l-o;return l===o?t=0:r===l?t=(s-n)/a:s===l?t=2+(n-r)/a:n===l&&(t=4+(r-s)/a),(t=Math.min(60*t,360))<0&&(t+=360),i=(o+l)/2,[t,100*(l===o?0:i<=.5?a/(l+o):a/(2-l-o)),100*i]},o.rgb.hsv=function(e){var t,i,r,s,n,o=e[0]/255,l=e[1]/255,a=e[2]/255,h=Math.max(o,l,a),c=h-Math.min(o,l,a),d=function(e){return(h-e)/6/c+.5};return 0===c?s=n=0:(n=c/h,t=d(o),i=d(l),r=d(a),o===h?s=r-i:l===h?s=1/3+t-r:a===h&&(s=2/3+i-t),s<0?s+=1:s>1&&(s-=1)),[360*s,100*n,100*h]},o.rgb.hwb=function(e){var t=e[0],i=e[1],r=e[2];return[o.rgb.hsl(e)[0],1/255*Math.min(t,Math.min(i,r))*100,100*(r=1-1/255*Math.max(t,Math.max(i,r)))]},o.rgb.cmyk=function(e){var t,i=e[0]/255,r=e[1]/255,s=e[2]/255;return[100*((1-i-(t=Math.min(1-i,1-r,1-s)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-s-t)/(1-t)||0),100*t]},o.rgb.keyword=function(e){var t=s[e];if(t)return t;var i,n,o,l=1/0;for(var a in r)if(r.hasOwnProperty(a)){var h=(n=e,o=r[a],Math.pow(n[0]-o[0],2)+Math.pow(n[1]-o[1],2)+Math.pow(n[2]-o[2],2));h<l&&(l=h,i=a)}return i},o.keyword.rgb=function(e){return r[e]},o.rgb.xyz=function(e){var t=e[0]/255,i=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*i+.0722*r),100*(.0193*t+.1192*i+.9505*r)]},o.rgb.lab=function(e){var t=o.rgb.xyz(e),i=t[0],r=t[1],s=t[2];return r/=100,s/=108.883,i=(i/=95.047)>.008856?Math.pow(i,1/3):7.787*i+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(i-r),200*(r-(s=s>.008856?Math.pow(s,1/3):7.787*s+16/116))]},o.hsl.rgb=function(e){var t,i,r,s,n,o=e[0]/360,l=e[1]/100,a=e[2]/100;if(0===l)return[n=255*a,n,n];t=2*a-(i=a<.5?a*(1+l):a+l-a*l),s=[0,0,0];for(var h=0;h<3;h++)(r=o+1/3*-(h-1))<0&&r++,r>1&&r--,n=6*r<1?t+6*(i-t)*r:2*r<1?i:3*r<2?t+(i-t)*(2/3-r)*6:t,s[h]=255*n;return s},o.hsl.hsv=function(e){var t=e[0],i=e[1]/100,r=e[2]/100,s=i,n=Math.max(r,.01);return i*=(r*=2)<=1?r:2-r,s*=n<=1?n:2-n,[t,100*(0===r?2*s/(n+s):2*i/(r+i)),(r+i)/2*100]},o.hsv.rgb=function(e){var t=e[0]/60,i=e[1]/100,r=e[2]/100,s=Math.floor(t)%6,n=t-Math.floor(t),o=255*r*(1-i),l=255*r*(1-i*n),a=255*r*(1-i*(1-n));switch(r*=255,s){case 0:return[r,a,o];case 1:return[l,r,o];case 2:return[o,r,a];case 3:return[o,l,r];case 4:return[a,o,r];case 5:return[r,o,l]}},o.hsv.hsl=function(e){var t,i,r,s=e[0],n=e[1]/100,o=e[2]/100,l=Math.max(o,.01);return r=(2-n)*o,i=n*l,[s,100*(i=(i/=(t=(2-n)*l)<=1?t:2-t)||0),100*(r/=2)]},o.hwb.rgb=function(e){var t,i,r,s,n,o,l,a=e[0]/360,h=e[1]/100,c=e[2]/100,d=h+c;switch(d>1&&(h/=d,c/=d),r=6*a-(t=Math.floor(6*a)),0!=(1&t)&&(r=1-r),s=h+r*((i=1-c)-h),t){default:n=i,o=s,l=h;break;case 1:n=s,o=i,l=h;break;case 2:n=h,o=i,l=s;break;case 3:n=h,o=s,l=i;break;case 4:n=s,o=h,l=i;break;case 5:n=i,o=h,l=s}return[255*n,255*o,255*l]},o.cmyk.rgb=function(e){var t=e[0]/100,i=e[1]/100,r=e[2]/100,s=e[3]/100;return[255*(1-Math.min(1,t*(1-s)+s)),255*(1-Math.min(1,i*(1-s)+s)),255*(1-Math.min(1,r*(1-s)+s))]},o.xyz.rgb=function(e){var t,i,r,s=e[0]/100,n=e[1]/100,o=e[2]/100;return i=-.9689*s+1.8758*n+.0415*o,r=.0557*s+-.204*n+1.057*o,t=(t=3.2406*s+-1.5372*n+-.4986*o)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(i=Math.min(Math.max(0,i),1)),255*(r=Math.min(Math.max(0,r),1))]},o.xyz.lab=function(e){var t=e[0],i=e[1],r=e[2];return i/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(t-i),200*(i-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},o.lab.xyz=function(e){var t,i,r,s=e[0];t=e[1]/500+(i=(s+16)/116),r=i-e[2]/200;var n=Math.pow(i,3),o=Math.pow(t,3),l=Math.pow(r,3);return i=n>.008856?n:(i-16/116)/7.787,t=o>.008856?o:(t-16/116)/7.787,r=l>.008856?l:(r-16/116)/7.787,[t*=95.047,i*=100,r*=108.883]},o.lab.lch=function(e){var t,i=e[0],r=e[1],s=e[2];return(t=360*Math.atan2(s,r)/2/Math.PI)<0&&(t+=360),[i,Math.sqrt(r*r+s*s),t]},o.lch.lab=function(e){var t,i=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[i,r*Math.cos(t),r*Math.sin(t)]},o.rgb.ansi16=function(e){var t=e[0],i=e[1],r=e[2],s=1 in arguments?arguments[1]:o.rgb.hsv(e)[2];if(0===(s=Math.round(s/50)))return 30;var n=30+(Math.round(r/255)<<2|Math.round(i/255)<<1|Math.round(t/255));return 2===s&&(n+=60),n},o.hsv.ansi16=function(e){return o.rgb.ansi16(o.hsv.rgb(e),e[2])},o.rgb.ansi256=function(e){var t=e[0],i=e[1],r=e[2];return t===i&&i===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(i/255*5)+Math.round(r/255*5)},o.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var i=.5*(1+~~(e>50));return[(1&t)*i*255,(t>>1&1)*i*255,(t>>2&1)*i*255]},o.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var i;return e-=16,[Math.floor(e/36)/5*255,Math.floor((i=e%36)/6)/5*255,i%6/5*255]},o.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},o.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var i=t[0];3===t[0].length&&(i=i.split("").map((function(e){return e+e})).join(""));var r=parseInt(i,16);return[r>>16&255,r>>8&255,255&r]},o.rgb.hcg=function(e){var t,i=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(Math.max(i,r),s),o=Math.min(Math.min(i,r),s),l=n-o;return t=l<=0?0:n===i?(r-s)/l%6:n===r?2+(s-i)/l:4+(i-r)/l+4,t/=6,[360*(t%=1),100*l,100*(l<1?o/(1-l):0)]},o.hsl.hcg=function(e){var t,i=e[1]/100,r=e[2]/100,s=0;return(t=r<.5?2*i*r:2*i*(1-r))<1&&(s=(r-.5*t)/(1-t)),[e[0],100*t,100*s]},o.hsv.hcg=function(e){var t=e[1]/100,i=e[2]/100,r=t*i,s=0;return r<1&&(s=(i-r)/(1-r)),[e[0],100*r,100*s]},o.hcg.rgb=function(e){var t=e[0]/360,i=e[1]/100,r=e[2]/100;if(0===i)return[255*r,255*r,255*r];var s,n=[0,0,0],o=t%1*6,l=o%1,a=1-l;switch(Math.floor(o)){case 0:n[0]=1,n[1]=l,n[2]=0;break;case 1:n[0]=a,n[1]=1,n[2]=0;break;case 2:n[0]=0,n[1]=1,n[2]=l;break;case 3:n[0]=0,n[1]=a,n[2]=1;break;case 4:n[0]=l,n[1]=0,n[2]=1;break;default:n[0]=1,n[1]=0,n[2]=a}return s=(1-i)*r,[255*(i*n[0]+s),255*(i*n[1]+s),255*(i*n[2]+s)]},o.hcg.hsv=function(e){var t=e[1]/100,i=t+e[2]/100*(1-t),r=0;return i>0&&(r=t/i),[e[0],100*r,100*i]},o.hcg.hsl=function(e){var t=e[1]/100,i=e[2]/100*(1-t)+.5*t,r=0;return i>0&&i<.5?r=t/(2*i):i>=.5&&i<1&&(r=t/(2*(1-i))),[e[0],100*r,100*i]},o.hcg.hwb=function(e){var t=e[1]/100,i=t+e[2]/100*(1-t);return[e[0],100*(i-t),100*(1-i)]},o.hwb.hcg=function(e){var t=e[1]/100,i=1-e[2]/100,r=i-t,s=0;return r<1&&(s=(i-r)/(1-r)),[e[0],100*r,100*s]},o.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},o.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},o.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},o.gray.hsl=o.gray.hsv=function(e){return[0,0,e[0]]},o.gray.hwb=function(e){return[0,100,e[0]]},o.gray.cmyk=function(e){return[0,0,0,e[0]]},o.gray.lab=function(e){return[e[0],0,0]},o.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),i=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(i.length)+i},o.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},85:(e,t,i)=>{var r=i(168),s=i(111),n={};Object.keys(r).forEach((function(e){n[e]={},Object.defineProperty(n[e],"channels",{value:r[e].channels}),Object.defineProperty(n[e],"labels",{value:r[e].labels});var t=s(e);Object.keys(t).forEach((function(i){var r=t[i];n[e][i]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var i=e(t);if("object"==typeof i)for(var r=i.length,s=0;s<r;s++)i[s]=Math.round(i[s]);return i};return"conversion"in e&&(t.conversion=e.conversion),t}(r),n[e][i].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)}))})),e.exports=n},111:(e,t,i)=>{var r=i(168);function s(e,t){return function(i){return t(e(i))}}function n(e,t){for(var i=[t[e].parent,e],n=r[t[e].parent][e],o=t[e].parent;t[o].parent;)i.unshift(t[o].parent),n=s(r[t[o].parent][o],n),o=t[o].parent;return n.conversion=i,n}e.exports=function(e){for(var t=function(e){var t=function(){for(var e={},t=Object.keys(r),i=t.length,s=0;s<i;s++)e[t[s]]={distance:-1,parent:null};return e}(),i=[e];for(t[e].distance=0;i.length;)for(var s=i.pop(),n=Object.keys(r[s]),o=n.length,l=0;l<o;l++){var a=n[l],h=t[a];-1===h.distance&&(h.distance=t[s].distance+1,h.parent=s,i.unshift(a))}return t}(e),i={},s=Object.keys(t),o=s.length,l=0;l<o;l++){var a=s[l];null!==t[a].parent&&(i[a]=n(a,t))}return i}},874:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},818:(e,t,i)=>{var r=i(541),s=i(851),n={};for(var o in r)r.hasOwnProperty(o)&&(n[r[o]]=o);var l=e.exports={to:{},get:{}};function a(e,t,i){return Math.min(Math.max(t,e),i)}function h(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}l.get=function(e){var t,i;switch(e.substring(0,3).toLowerCase()){case"hsl":t=l.get.hsl(e),i="hsl";break;case"hwb":t=l.get.hwb(e),i="hwb";break;default:t=l.get.rgb(e),i="rgb"}return t?{model:i,value:t}:null},l.get.rgb=function(e){if(!e)return null;var t,i,s,n=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(s=t[2],t=t[1],i=0;i<3;i++){var o=2*i;n[i]=parseInt(t.slice(o,o+2),16)}s&&(n[3]=parseInt(s,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(s=(t=t[1])[3],i=0;i<3;i++)n[i]=parseInt(t[i]+t[i],16);s&&(n[3]=parseInt(s+s,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(i=0;i<3;i++)n[i]=parseInt(t[i+1],0);t[4]&&(n[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(n=r[t[1]])?(n[3]=1,n):null:null;for(i=0;i<3;i++)n[i]=Math.round(2.55*parseFloat(t[i+1]));t[4]&&(n[3]=parseFloat(t[4]))}for(i=0;i<3;i++)n[i]=a(n[i],0,255);return n[3]=a(n[3],0,1),n},l.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var i=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,a(parseFloat(t[2]),0,100),a(parseFloat(t[3]),0,100),a(isNaN(i)?1:i,0,1)]}return null},l.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var i=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,a(parseFloat(t[2]),0,100),a(parseFloat(t[3]),0,100),a(isNaN(i)?1:i,0,1)]}return null},l.to.hex=function(){var e=s(arguments);return"#"+h(e[0])+h(e[1])+h(e[2])+(e[3]<1?h(Math.round(255*e[3])):"")},l.to.rgb=function(){var e=s(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},l.to.rgb.percent=function(){var e=s(arguments),t=Math.round(e[0]/255*100),i=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+i+"%, "+r+"%)":"rgba("+t+"%, "+i+"%, "+r+"%, "+e[3]+")"},l.to.hsl=function(){var e=s(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},l.to.hwb=function(){var e=s(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},l.to.keyword=function(e){return n[e.slice(0,3)]}},541:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},767:(e,t,i)=>{"use strict";var r=i(818),s=i(85),n=[].slice,o=["keyword","gray","hex"],l={};Object.keys(s).forEach((function(e){l[n.call(s[e].labels).sort().join("")]=e}));var a={};function h(e,t){if(!(this instanceof h))return new h(e,t);if(t&&t in o&&(t=null),t&&!(t in s))throw new Error("Unknown model: "+t);var i,c;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof h)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var d=r.get(e);if(null===d)throw new Error("Unable to parse color from string: "+e);this.model=d.model,c=s[this.model].channels,this.color=d.value.slice(0,c),this.valpha="number"==typeof d.value[c]?d.value[c]:1}else if(e.length){this.model=t||"rgb",c=s[this.model].channels;var u=n.call(e,0,c);this.color=f(u,c),this.valpha="number"==typeof e[c]?e[c]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var g=Object.keys(e);"alpha"in e&&(g.splice(g.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var m=g.sort().join("");if(!(m in l))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=l[m];var p=s[this.model].labels,v=[];for(i=0;i<p.length;i++)v.push(e[p[i]]);this.color=f(v)}if(a[this.model])for(c=s[this.model].channels,i=0;i<c;i++){var y=a[this.model][i];y&&(this.color[i]=y(this.color[i]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function c(e,t,i){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(a[e]||(a[e]=[]))[t]=i})),e=e[0],function(r){var s;return arguments.length?(i&&(r=i(r)),(s=this[e]()).color[t]=r,s):(s=this[e]().color[t],i&&(s=i(s)),s)}}function d(e){return function(t){return Math.max(0,Math.min(e,t))}}function u(e){return Array.isArray(e)?e:[e]}function f(e,t){for(var i=0;i<t;i++)"number"!=typeof e[i]&&(e[i]=0);return e}h.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in r.to?this:this.rgb(),i=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return r.to[t.model](i)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),i=1===t.valpha?t.color:t.color.concat(this.valpha);return r.to.rgb.percent(i)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=s[this.model].channels,i=s[this.model].labels,r=0;r<t;r++)e[i[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new h(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new h(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:c("rgb",0,d(255)),green:c("rgb",1,d(255)),blue:c("rgb",2,d(255)),hue:c(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:c("hsl",1,d(100)),lightness:c("hsl",2,d(100)),saturationv:c("hsv",1,d(100)),value:c("hsv",2,d(100)),chroma:c("hcg",1,d(100)),gray:c("hcg",2,d(100)),white:c("hwb",1,d(100)),wblack:c("hwb",2,d(100)),cyan:c("cmyk",0,d(100)),magenta:c("cmyk",1,d(100)),yellow:c("cmyk",2,d(100)),black:c("cmyk",3,d(100)),x:c("xyz",0,d(100)),y:c("xyz",1,d(100)),z:c("xyz",2,d(100)),l:c("lab",0,d(100)),a:c("lab",1),b:c("lab",2),keyword:function(e){return arguments.length?new h(e):s[this.model].keyword(this.color)},hex:function(e){return arguments.length?new h(e):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],i=0;i<e.length;i++){var r=e[i]/255;t[i]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),i=e.luminosity();return t>i?(t+.05)/(i+.05):(i+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return h.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),i=t.color[0];return i=(i=(i+e)%360)<0?360+i:i,t.color[0]=i,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var i=e.rgb(),r=this.rgb(),s=void 0===t?.5:t,n=2*s-1,o=i.alpha()-r.alpha(),l=((n*o==-1?n:(n+o)/(1+n*o))+1)/2,a=1-l;return h.rgb(l*i.red()+a*r.red(),l*i.green()+a*r.green(),l*i.blue()+a*r.blue(),i.alpha()*s+r.alpha()*(1-s))}},Object.keys(s).forEach((function(e){if(-1===o.indexOf(e)){var t=s[e].channels;h.prototype[e]=function(){if(this.model===e)return new h(this);if(arguments.length)return new h(arguments,e);var i="number"==typeof arguments[t]?t:this.valpha;return new h(u(s[this.model][e].raw(this.color)).concat(i),e)},h[e]=function(i){return"number"==typeof i&&(i=f(n.call(arguments),t)),new h(i,e)}}})),e.exports=h},128:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});var r=i(645),s=i.n(r)()((function(e){return e[1]}));s.push([e.id,".cursor_default {\n  cursor: default;\n}\n.cursor_pointer {\n  cursor: pointer;\n}\n.cursor_grab {\n  cursor: grabbing;\n}\n.cursor_move {\n  cursor: move;\n}\n.cursor_wait {\n  cursor: wait;\n}\n.cursor_select {\n  cursor: crosshair;\n}\n.cursor_l_r_arrow {\n  cursor: e-resize;\n}\n.cursor_t_b_arrow {\n  cursor: s-resize;\n}\n.cursor_lb_rt_arrow {\n  cursor: ne-resize;\n}\n.cursor_lt_rb_arrow {\n  cursor: nw-resize;\n}\n.cursor_text {\n  cursor: text;\n}\n.cursor_disabled {\n  cursor: not-allowed;\n}\n.cursor_zoom_in {\n  cursor: zoom-in;\n}\n.cursor_zoom_out {\n  cursor: zoom-out;\n}\ncanvas {\n  outline: none;\n}\n",""]);const n=s},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=e(t);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,r){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(r)for(var n=0;n<this.length;n++){var o=this[n][0];null!=o&&(s[o]=!0)}for(var l=0;l<e.length;l++){var a=[].concat(e[l]);r&&s[a[0]]||(i&&(a[2]?a[2]="".concat(i," and ").concat(a[2]):a[2]=i),t.push(a))}},t}},171:e=>{e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},851:(e,t,i)=>{"use strict";var r=i(171),s=Array.prototype.concat,n=Array.prototype.slice,o=e.exports=function(e){for(var t=[],i=0,o=e.length;i<o;i++){var l=e[i];r(l)?t=s.call(t,n.call(l)):t.push(l)}return t};o.wrap=function(e){return function(){return e(o(arguments))}}},379:(e,t,i)=>{"use strict";var r,s=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),n=[];function o(e){for(var t=-1,i=0;i<n.length;i++)if(n[i].identifier===e){t=i;break}return t}function l(e,t){for(var i={},r=[],s=0;s<e.length;s++){var l=e[s],a=t.base?l[0]+t.base:l[0],h=i[a]||0,c="".concat(a," ").concat(h);i[a]=h+1;var d=o(c),u={css:l[1],media:l[2],sourceMap:l[3]};-1!==d?(n[d].references++,n[d].updater(u)):n.push({identifier:c,updater:m(u,t),references:1}),r.push(c)}return r}function a(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var n=i.nc;n&&(r.nonce=n)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=s(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var h,c=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join("\n")});function d(e,t,i,r){var s=i?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=c(t,s);else{var n=document.createTextNode(s),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(n,o[t]):e.appendChild(n)}}function u(e,t,i){var r=i.css,s=i.media,n=i.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var f=null,g=0;function m(e,t){var i,r,s;if(t.singleton){var n=g++;i=f||(f=a(t)),r=d.bind(null,i,n,!1),s=d.bind(null,i,n,!0)}else i=a(t),r=u.bind(null,i,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var i=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<i.length;r++){var s=o(i[r]);n[s].references--}for(var a=l(e,t),h=0;h<i.length;h++){var c=o(i[h]);0===n[c].references&&(n[c].updater(),n.splice(c,1))}i=a}}}},586:(e,t,i)=>{"use strict";var r;i.d(t,{Z:()=>c});var s=new Uint8Array(16);function n(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(s)}const o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function(e){return"string"==typeof e&&o.test(e)};for(var a=[],h=0;h<256;++h)a.push((h+256).toString(16).substr(1));const c=function(e,t,i){var r=(e=e||{}).random||(e.rng||n)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){i=i||0;for(var s=0;s<16;++s)t[i+s]=r[s];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase();if(!l(i))throw TypeError("Stringified UUID is invalid");return i}(r)}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={id:e,exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__=__webpack_require__(248)})();